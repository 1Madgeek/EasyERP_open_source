<%collection.forEach(function (el){%>
<tr class="_contractJobsListItem">
    <% var adr = (el.jobPrice/(100 * (el.totalWorked - el.totalQAWorked - el.totalDesignWorked)))%>
    <% var tadr = (el.jobPrice/(100 * el.totalWorked))%>
    <td class="_contractJobsStatusBlock <%=el.workflow.name === 'Finished' ? 'finished' : 'inProgress'%>"><span><%=el.workflow ? el.workflow.name : ''%></span></td>
    <td class="_contractJobsJobBlock">
        <div><span><%=el.name%> in <%=el.project.name%></span></div>
        <div><span><span>For </span><%=el.customer%></span></div>
        <div><span>From </span><span><%=el.tCardMinDate%></span><span> to </span><span><%=el.tCardMaxDate%></span></div>
        <%if (el.salesManager && el.salesManager.name) {%>
        <div><span>Sales Manager: </span><span><%=el.salesManager ? el.salesManager.name : ''%></span></div>
        <%}%>
        <%if (el.projectManager && el.projectManager.name) {%>
        <div><span>Project Manager: </span><span><%=el.projectManager ? el.projectManager.name : ''%></span></div>
        <%}%>
        <div><span>Total Hours: </span><span><%=el.totalWorked%></span></div>
        <%if (el.totalWorked - el.totalQAWorked - el.totalDesignWorked > 0) {%>
        <div><span>Development Hours: </span><span><%=(el.totalWorked - el.totalQAWorked - el.totalDesignWorked)%></span></div>
        <%}%>
        <%if (adr && isFinite(adr)) {%>
        <div><span>ADR: </span><span><%=isFinite(adr) ? adr.toFixed(2): 0%></span></div>
        <%}%>
        <%if (tadr && isFinite(tadr)) {%>
        <div><span>Total ADR: </span><span><%=isFinite(tadr) ? tadr.toFixed(2): 0%></span></div>
        <%}%>
    </td>
    <td class="_contractJobsInvoiceBlock">
        <%if (el.invoice && el.invoice._id) {%>
        <div><span><%=el.invoice && el.invoice.name ? el.invoice.name : ''%></span></div>
        <div><span>Invoice Date: </span><span><%=el.invoice && el.invoice.date ? utcDateToLocaleDate(new Date(el.invoice.date)) : ''%></span></div>
        <div><span>Due Date: </span><span><%=el.invoice && el.invoice.dueDate ? utcDateToLocaleDate(new Date(el.invoice.dueDate)) : ''%></span></div>
        <%}%>
    </td>
    <td class="_contractJobsRevenueBlock">
        <%if (el.jobPrice) {%>
        <div><%=currencySplitter((el.jobPrice/100).toFixed(2))%></div>
        <div><span>Quoted: </span><span><%=el.invoice && el.invoice.name ? 0.00 : currencySplitter((el.jobPrice/100).toFixed(2))%></span></div>
        <%if (el.proforma && el.proforma.sum && !el.invoice && !el.invoice._id) {%>
        <div><span>Proformed: </span><span><%=currencySplitter((el.proforma.sum/100).toFixed(2))%></span></div>
        <%}%>
        <div><span>Invoiced: </span><span><%=el.invoice && el.invoice.name ? currencySplitter((el.jobPrice/100).toFixed(2)) : 0.00%></span></div>
        <%}%>
    </td>
    <td class="_contractJobsCostBlock">
        <span><%=currencySplitter(((el.costMaterials + el.costLabour)/100).toFixed(2))%></span>
        <%if (el.costMaterials) {%>
        <span>Materials: </span><span><%=currencySplitter((el.costMaterials/100).toFixed(2))%></span>
        <%}%>
        <%if (el.costLabour) {%>
        <span>Labour: </span><span><%=currencySplitter((el.costLabour/100).toFixed(2))%></span>
        <%}%>
    </td>
    <td class="_contractJobsProfitBlock"><%=currencySplitter((((el.jobPrice - (el.costMaterials + el.costLabour)) / (el.costMaterials + el.costLabour)) * 100).toFixed(2))%></td>
</tr>
<% }) %>